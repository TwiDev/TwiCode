(self["webpackJsonp"]=self["webpackJsonp"]||[]).push([["chunk-3bd95060"],{1156:function(e,t,n){"use strict";e.exports.setItem=function(e,t){return new Promise((function(n){localStorage.setItem(e,t),n()}))},e.exports.getItem=function(e){return Promise.resolve(localStorage.getItem(e))},e.exports.removeItem=function(e){return new Promise((function(t){localStorage.removeItem(e),t()}))}},1816:function(e,t,n){"use strict";(function(t){var o=n("440d"),r=n("9c59"),i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,a="[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]",u=new RegExp("^"+a+"+");function p(e){return(e||"").toString().replace(u,"")}var c=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],l={hash:1,query:1};function h(e){var n;n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};var o=n.location||{};e=e||o;var r,s={},a=typeof e;if("blob:"===e.protocol)s=new m(unescape(e.pathname),{});else if("string"===a)for(r in s=new m(e,{}),l)delete s[r];else if("object"===a){for(r in e)r in l||(s[r]=e[r]);void 0===s.slashes&&(s.slashes=i.test(e.href))}return s}function d(e){e=p(e);var t=s.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function f(e,t){if(""===e)return t;var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=n.length,r=n[o-1],i=!1,s=0;while(o--)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),s++):s&&(0===o&&(i=!0),n.splice(o,1),s--);return i&&n.unshift(""),"."!==r&&".."!==r||n.push(""),n.join("/")}function m(e,t,n){if(e=p(e),!(this instanceof m))return new m(e,t,n);var i,s,a,u,l,v,y=c.slice(),g=typeof t,w=this,_=0;for("object"!==g&&"string"!==g&&(n=t,t=null),n&&"function"!==typeof n&&(n=r.parse),t=h(t),s=d(e||""),i=!s.protocol&&!s.slashes,w.slashes=s.slashes||i&&t.slashes,w.protocol=s.protocol||t.protocol||"",e=s.rest,s.slashes||(y[3]=[/(.*)/,"pathname"]);_<y.length;_++)u=y[_],"function"!==typeof u?(a=u[0],v=u[1],a!==a?w[v]=e:"string"===typeof a?~(l=e.indexOf(a))&&("number"===typeof u[2]?(w[v]=e.slice(0,l),e=e.slice(l+u[2])):(w[v]=e.slice(l),e=e.slice(0,l))):(l=a.exec(e))&&(w[v]=l[1],e=e.slice(0,l.index)),w[v]=w[v]||i&&u[3]&&t[v]||"",u[4]&&(w[v]=w[v].toLowerCase())):e=u(e);n&&(w.query=n(w.query)),i&&t.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==t.pathname)&&(w.pathname=f(w.pathname,t.pathname)),o(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(u=w.auth.split(":"),w.username=u[0]||"",w.password=u[1]||""),w.origin=w.protocol&&w.host&&"file:"!==w.protocol?w.protocol+"//"+w.host:"null",w.href=w.toString()}function v(e,t,n){var i=this;switch(e){case"query":"string"===typeof t&&t.length&&(t=(n||r.parse)(t)),i[e]=t;break;case"port":i[e]=t,o(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";i[e]=t.charAt(0)!==s?s+t:t}else i[e]=t;break;default:i[e]=t}for(var a=0;a<c.length;a++){var u=c[a];u[4]&&(i[u[1]]=i[u[1]].toLowerCase())}return i.origin=i.protocol&&i.host&&"file:"!==i.protocol?i.protocol+"//"+i.host:"null",i.href=i.toString(),i}function y(e){e&&"function"===typeof e||(e=r.stringify);var t,n=this,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var i=o+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,t="object"===typeof n.query?e(n.query):n.query,t&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}m.prototype={set:v,toString:y},m.extractProtocol=d,m.location=h,m.trimLeft=p,m.qs=r,e.exports=m}).call(this,n("c8ba"))},"24f4":function(e,t,n){var o=n("84a2");function r(e,t,n){var o=t.progress,r=t.bytesUploaded,i=t.bytesTotal;o&&(e.uppy.log("Upload progress: "+o),e.uppy.emit("upload-progress",n,{uploader:e,bytesUploaded:r,bytesTotal:i}))}e.exports=o(r,300,{leading:!0,trailing:!0})},"2ba9":function(e,t,n){"use strict";var o=n("dd81"),r=n("9ea4"),i=n("e278");e.exports={RequestClient:o,Provider:r,Socket:i}},"440d":function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},"51f0":function(e,t,n){var o,r;function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}var u="function"===typeof URL?URL:n("1816"),p=n("b880"),c=p.Plugin,l=n("de33"),h=n("caf1"),d=n("abca"),f=n("f590"),m=n("2ba9"),v=m.RequestClient,y=n("cfd4"),g=n("e8af");function w(e,t){return new u(t,e).toString()}function _(e,t){var n=t.headers?t.headers["content-type"]:t.getResponseHeader("Content-Type");if(null===n)return!1;var o=n.replace(/;.*$/,"").toLowerCase();if("string"===typeof o){if("application/xml"===o||"text/xml"===o)return!0;if("text/html"===o&&/^<\?xml /.test(e))return!0}return!1}function b(e,t){var n=e.indexOf("<"+t+">"),o=e.indexOf("</"+t+">",n);return-1!==n&&-1!==o?e.slice(n+t.length+2,o):""}function R(e){if(e&&e.error){var t=new Error(e.message);throw a(t,e.error),t}return e}var U=!1;e.exports=(r=o=function(e){function t(t,n){var o;o=e.call(this,t,n)||this,o.type="uploader",o.id=o.opts.id||"AwsS3",o.title="AWS S3",o.defaultLocale={strings:{preparingUpload:"Preparing upload..."}};var r={timeout:3e4,limit:0,metaFields:[],getUploadParameters:o.getUploadParameters.bind(i(o))};return o.opts=a({},r,{},n),o.i18nInit(),o.client=new v(t,n),o.handleUpload=o.handleUpload.bind(i(o)),o.requests=new h(o.opts.limit),o}s(t,e);var n=t.prototype;return n.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},n.i18nInit=function(){this.translator=new l([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},n.getUploadParameters=function(e){if(!this.opts.companionUrl)throw new Error("Expected a `companionUrl` option containing a Companion address.");var t=encodeURIComponent(e.meta.name),n=encodeURIComponent(e.meta.type),o={};this.opts.metaFields.forEach((function(t){null!=e.meta[t]&&(o[t]=e.meta[t].toString())}));var r=y({filename:t,type:n,metadata:o});return this.client.get("s3/params?"+r).then(R)},n.validateParameters=function(e,t){var n="object"===typeof t&&t&&"string"===typeof t.url&&("object"===typeof t.fields||null==t.fields)&&(null==t.method||/^(put|post)$/i.test(t.method));if(!n){var o=new TypeError("AwsS3: got incorrect result from 'getUploadParameters()' for file '"+e.name+"', expected an object '{ url, method, fields, headers }'.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.");throw console.error(o),o}},n.handleUpload=function(e){var t=this,n=Object.create(null);function o(e){var t=e.id;f(n,t)&&n[t].abort()}this.uppy.on("file-removed",o),e.forEach((function(e){var n=t.uppy.getFile(e);t.uppy.emit("upload-started",n)}));var r=this.requests.wrapPromiseFunction((function(e){return t.opts.getUploadParameters(e)})),i=e.length;return d(e.map((function(e,o){var s=t.uppy.getFile(e);return n[e]=r(s),n[e].then((function(r){delete n[e],t.validateParameters(s,r);var u=r.method,p=void 0===u?"post":u,c=r.url,l=r.fields,h=r.headers,d={method:p,formData:"post"===p.toLowerCase(),endpoint:c,metaFields:l?Object.keys(l):[]};return h&&(d.headers=h),t.uppy.setFileState(s.id,{meta:a({},s.meta,{},l),xhrUpload:d}),t._uploader.uploadFile(s.id,o,i)})).catch((function(o){delete n[e],t.uppy.emit("upload-error",s,o)}))}))).then((function(e){return t.uppy.off("file-removed",o),e}))},n.install=function(){var e=this.uppy;function t(t,n){var o=this;return _(t,n)?{location:w(n.responseURL,b(t,"Location")),bucket:b(t,"Bucket"),key:b(t,"Key"),etag:b(t,"ETag")}:"POST"===o.method.toUpperCase()?(U||(e.log("[AwsS3] No response data found, make sure to set the success_action_status AWS SDK option to 201. See https://uppy.io/docs/aws-s3/#POST-Uploads","warning"),U=!0),{location:null}):n.responseURL?{location:n.responseURL.replace(/\?.*$/,"")}:{location:null}}function n(e,t){if(_(e,t)){var n=b(e,"Message");return new Error(n)}}this.uppy.addUploader(this.handleUpload);var o={fieldName:"file",responseUrlFieldName:"location",timeout:this.opts.timeout,__queue:this.requests,responseType:"text",getResponseData:this.opts.getResponseData||t,getResponseError:n};this._uploader=new g(this.uppy,o),this._uploader.i18n=this.i18n},n.uninstall=function(){this.uppy.removePreProcessor(this.handleUpload)},t}(c),o.VERSION="1.6.0",r)},"9c59":function(e,t,n){"use strict";var o,r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function s(e){var t,n=/([^=?&]+)=?([^&]*)/g,o={};while(t=n.exec(e)){var r=i(t[1]),s=i(t[2]);null===r||null===s||r in o||(o[r]=s)}return o}function a(e,t){t=t||"";var n,i,s=[];for(i in"string"!==typeof t&&(t="?"),e)if(r.call(e,i)){if(n=e[i],n||null!==n&&n!==o&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;s.push(i+"="+n)}return s.length?t+s.join("&"):""}t.stringify=a,t.parse=s},"9ea4":function(e,t,n){"use strict";function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var i=n("dd81"),s=n("1156"),a=function(e){return e.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")};e.exports=function(e){function t(t,n){var o;return o=e.call(this,t,n)||this,o.provider=n.provider,o.id=o.provider,o.authProvider=n.authProvider||o.provider,o.name=o.opts.name||a(o.id),o.pluginId=o.opts.pluginId,o.tokenKey="companion-"+o.pluginId+"-auth-token",o}r(t,e);var n=t.prototype;return n.headers=function(){var t=this;return new Promise((function(n,r){e.prototype.headers.call(t).then((function(e){t.getAuthToken().then((function(t){n(o({},e,{"uppy-auth-token":t}))}))})).catch(r)}))},n.onReceiveResponse=function(t){t=e.prototype.onReceiveResponse.call(this,t);var n=this.uppy.getPlugin(this.pluginId),o=n.getPluginState().authenticated,r=o?401!==t.status:t.status<400;return n.setPluginState({authenticated:r}),t},n.setAuthToken=function(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)},n.getAuthToken=function(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)},n.authUrl=function(){return this.hostname+"/"+this.id+"/connect"},n.fileUrl=function(e){return this.hostname+"/"+this.id+"/get/"+e},n.list=function(e){return this.get(this.id+"/list/"+(e||""))},n.logout=function(){var e=this;return new Promise((function(t,n){e.get(e.id+"/logout").then((function(o){e.uppy.getPlugin(e.pluginId).storage.removeItem(e.tokenKey).then((function(){return t(o)})).catch(n)})).catch(n)}))},t.initPlugin=function(e,t,n){if(e.type="acquirer",e.files=[],n&&(e.opts=o({},n,t)),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){var r=t.companionAllowedHosts;if("string"!==typeof r&&!Array.isArray(r)&&!(r instanceof RegExp))throw new TypeError(e.id+': the option "companionAllowedHosts" must be one of string, Array, RegExp');e.opts.companionAllowedHosts=r}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts="https://"+t.companionUrl.replace(/^\/\//,""):e.opts.companionAllowedHosts=t.companionUrl;e.storage=e.opts.storage||s},t}(i)},a746:function(e,t,n){"use strict";function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function r(e){var t="function"===typeof Map?new Map:void 0;return r=function(e){if(null===e||!a(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return s(e,arguments,p(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},r(e)}function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function s(e,t,n){return s=i()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=Function.bind.apply(e,o),i=new r;return n&&u(i,n.prototype),i},s.apply(null,arguments)}function a(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var c=function(e){function t(){var t;return t=e.call(this,"Authorization required")||this,t.name="AuthError",t.isAuthError=!0,t}return o(t,e),t}(r(Error));e.exports=c},ab50:function(e,t){e.exports=function(){function e(e){this._events=[],this._emitter=e}var t=e.prototype;return t.on=function(e,t){return this._events.push([e,t]),this._emitter.on(e,t)},t.remove=function(){var e=this;this._events.forEach((function(t){var n=t[0],o=t[1];e._emitter.off(n,o)}))},e}()},abca:function(e,t){e.exports=function(e){var t=[],n=[];function o(e){t.push(e)}function r(e){n.push(e)}var i=Promise.all(e.map((function(e){return e.then(o,r)})));return i.then((function(){return{successful:t,failed:n}}))}},c484:function(e,t){e.exports=function(e){var t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i,n=t.exec(e)[1],o=/^http:\/\//i.test(e)?"ws":"wss";return o+"://"+n}},caf1:function(e,t){function n(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}function o(){return new Error("Cancelled")}e.exports=function(){function e(e){this.limit="number"!==typeof e||0===e?1/0:e,this.activeRequests=0,this.queuedHandlers=[]}var t=e.prototype;return t._call=function(e){var t=this;this.activeRequests+=1;var n,o=!1;try{n=e()}catch(r){throw this.activeRequests-=1,r}return{abort:function(){o||(o=!0,t.activeRequests-=1,n(),t._queueNext())},done:function(){o||(o=!0,t.activeRequests-=1,t._queueNext())}}},t._queueNext=function(){var e=this;Promise.resolve().then((function(){e._next()}))},t._next=function(){if(!(this.activeRequests>=this.limit)&&0!==this.queuedHandlers.length){var e=this.queuedHandlers.shift(),t=this._call(e.fn);e.abort=t.abort,e.done=t.done}},t._queue=function(e,t){var o=this;void 0===t&&(t={});var r={fn:e,priority:t.priority||0,abort:function(){o._dequeue(r)},done:function(){throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=n(this.queuedHandlers,(function(e){return r.priority>e.priority}));return-1===i?this.queuedHandlers.push(r):this.queuedHandlers.splice(i,0,r),r},t._dequeue=function(e){var t=this.queuedHandlers.indexOf(e);-1!==t&&this.queuedHandlers.splice(t,1)},t.run=function(e,t){return this.activeRequests<this.limit?this._call(e):this._queue(e,t)},t.wrapPromiseFunction=function(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a,u=new Promise((function(r,s){a=n.run((function(){var t,n;try{n=Promise.resolve(e.apply(void 0,i))}catch(u){n=Promise.reject(u)}return n.then((function(e){t?s(t):(a.done(),r(e))}),(function(e){t?s(t):(a.done(),s(e))})),function(){t=o()}}),t)}));return u.abort=function(){a.abort()},u}},e}()},cfd4:function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function e(t,o){var r=[];for(var i in t)if(n.call(t,i)){var s,a=t[i],u=encodeURIComponent(i);s="object"===typeof a?e(a,o?o+"["+u+"]":u):(o?o+"["+u+"]":u)+"="+encodeURIComponent(a),r.push(s)}return r.join("&")}},dd81:function(e,t,n){"use strict";var o,r;function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i.apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var u=n("a746");function p(e){return e.replace(/\/$/,"")}e.exports=(r=o=function(){function e(e,t){this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1}var t=e.prototype;return t.headers=function(){var e=this.opts.companionHeaders||this.opts.serverHeaders||{};return Promise.resolve(i({},this.defaultHeaders,{},e))},t._getPostResponseFunc=function(e){var t=this;return function(n){return e?n:t.onReceiveResponse(n)}},t.onReceiveResponse=function(e){var t,n=this.uppy.getState(),o=n.companion||{},r=this.opts.companionUrl,s=e.headers;s.has("i-am")&&s.get("i-am")!==o[r]&&this.uppy.setState({companion:i({},o,(t={},t[r]=s.get("i-am"),t))});return e},t._getUrl=function(e){return/^(https?:|)\/\//.test(e)?e:this.hostname+"/"+e},t._json=function(e){if(401===e.status)throw new u;if(e.status<200||e.status>300){var t="Failed request with status: "+e.status+". "+e.statusText;return e.json().then((function(e){throw t=e.message?t+" message: "+e.message:t,t=e.requestId?t+" request-Id: "+e.requestId:t,new Error(t)})).catch((function(){throw new Error(t)}))}return e.json()},t.preflight=function(e){var t=this;return new Promise((function(n,o){if(t.preflightDone)return n(t.allowedHeaders.slice());fetch(t._getUrl(e),{method:"OPTIONS"}).then((function(e){e.headers.has("access-control-allow-headers")&&(t.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map((function(e){return e.trim().toLowerCase()}))),t.preflightDone=!0,n(t.allowedHeaders.slice())})).catch((function(e){t.uppy.log("[CompanionClient] unable to make preflight request "+e,"warning"),t.preflightDone=!0,n(t.allowedHeaders.slice())}))}))},t.preflightAndHeaders=function(e){var t=this;return Promise.all([this.preflight(e),this.headers()]).then((function(e){var n=e[0],o=e[1];return Object.keys(o).forEach((function(e){-1===n.indexOf(e.toLowerCase())&&(t.uppy.log("[CompanionClient] excluding unallowed header "+e),delete o[e])})),o}))},t.get=function(e,t){var n=this;return new Promise((function(o,r){n.preflightAndHeaders(e).then((function(i){fetch(n._getUrl(e),{method:"get",headers:i,credentials:"same-origin"}).then(n._getPostResponseFunc(t)).then((function(e){return n._json(e).then(o)})).catch((function(t){t=t.isAuthError?t:new Error("Could not get "+n._getUrl(e)+". "+t),r(t)}))})).catch(r)}))},t.post=function(e,t,n){var o=this;return new Promise((function(r,i){o.preflightAndHeaders(e).then((function(s){fetch(o._getUrl(e),{method:"post",headers:s,credentials:"same-origin",body:JSON.stringify(t)}).then(o._getPostResponseFunc(n)).then((function(e){return o._json(e).then(r)})).catch((function(t){t=t.isAuthError?t:new Error("Could not post "+o._getUrl(e)+". "+t),i(t)}))})).catch(i)}))},t.delete=function(e,t,n){var o=this;return new Promise((function(r,i){o.preflightAndHeaders(e).then((function(s){fetch(o.hostname+"/"+e,{method:"delete",headers:s,credentials:"same-origin",body:t?JSON.stringify(t):null}).then(o._getPostResponseFunc(n)).then((function(e){return o._json(e).then(r)})).catch((function(t){t=t.isAuthError?t:new Error("Could not delete "+o._getUrl(e)+". "+t),i(t)}))})).catch(i)}))},a(e,[{key:"hostname",get:function(){var e=this.uppy.getState(),t=e.companion,n=this.opts.companionUrl;return p(t&&t[n]?t[n]:n)}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client="+e.VERSION}}}]),e}(),o.VERSION="1.4.2",r)},e278:function(e,t,n){var o=n("9c1c");e.exports=function(){function e(e){this.opts=e,this._queued=[],this.isOpen=!1,this.emitter=o(),this._handleMessage=this._handleMessage.bind(this),this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this),e&&!1===e.autoOpen||this.open()}var t=e.prototype;return t.open=function(){var e=this;this.socket=new WebSocket(this.opts.target),this.socket.onopen=function(t){e.isOpen=!0;while(e._queued.length>0&&e.isOpen){var n=e._queued[0];e.send(n.action,n.payload),e._queued=e._queued.slice(1)}},this.socket.onclose=function(t){e.isOpen=!1},this.socket.onmessage=this._handleMessage},t.close=function(){this.socket&&this.socket.close()},t.send=function(e,t){this.isOpen?this.socket.send(JSON.stringify({action:e,payload:t})):this._queued.push({action:e,payload:t})},t.on=function(e,t){this.emitter.on(e,t)},t.emit=function(e,t){this.emitter.emit(e,t)},t.once=function(e,t){this.emitter.once(e,t)},t._handleMessage=function(e){try{var t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(n){console.log(n)}},e}()},e8af:function(e,t,n){function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}var r=n("ea39"),i=n("2ba9"),s=i.Provider,a=i.RequestClient,u=i.Socket,p=n("24f4"),c=n("c484"),l=n("ab50"),h=n("f0f4");function d(e,t){return t||(t=new Error("Upload error")),"string"===typeof t&&(t=new Error(t)),t instanceof Error||(t=o(new Error("Upload error"),{data:t})),t.request=e,t}function f(e){var t=e.data.slice(0,e.data.size,e.meta.type);return t}e.exports=function(){function e(e,t){this.uppy=e,this.opts=o({validateStatus:function(e,t,n){return e>=200&&e<300}},t),this.requests=t.__queue,this.uploaderEvents=Object.create(null)}var t=e.prototype;return t._getOptions=function(e){var t=this.uppy,n=t.getState().xhrUpload,r=o({},this.opts,{},n||{},{},e.xhrUpload||{},{headers:{}});return o(r.headers,this.opts.headers),n&&o(r.headers,n.headers),e.xhrUpload&&o(r.headers,e.xhrUpload.headers),r},t.uploadFile=function(e,t,n){var o=this.uppy.getFile(e);if(o.error)throw new Error(o.error);return o.isRemote?this._uploadRemoteFile(o,t,n):this._uploadLocalFile(o,t,n)},t._addMetadata=function(e,t,n){var o=Array.isArray(n.metaFields)?n.metaFields:Object.keys(t);o.forEach((function(n){e.append(n,t[n])}))},t._createFormDataUpload=function(e,t){var n=new FormData;this._addMetadata(n,e.meta,t);var o=f(e);return e.name?n.append(t.fieldName,o,e.meta.name):n.append(t.fieldName,o),n},t._createBareUpload=function(e,t){return e.data},t._onFileRemoved=function(e,t){this.uploaderEvents[e].on("file-removed",(function(n){e===n.id&&t(n.id)}))},t._onRetry=function(e,t){this.uploaderEvents[e].on("upload-retry",(function(n){e===n&&t()}))},t._onRetryAll=function(e,t){var n=this;this.uploaderEvents[e].on("retry-all",(function(o){n.uppy.getFile(e)&&t()}))},t._onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",(function(){n.uppy.getFile(e)&&t()}))},t._uploadLocalFile=function(e,t,n){var o=this,i=this._getOptions(e);return this.uppy.log("uploading "+t+" of "+n),new Promise((function(t,n){var s=i.formData?o._createFormDataUpload(e,i):o._createBareUpload(e,i),a=new XMLHttpRequest;o.uploaderEvents[e.id]=new l(o.uppy);var u=new h(i.timeout,(function(){a.abort(),c.done();var t=new Error(o.i18n("timedOut",{seconds:Math.ceil(i.timeout/1e3)}));o.uppy.emit("upload-error",e,t),n(t)})),p=r();a.upload.addEventListener("loadstart",(function(e){o.uppy.log("[AwsS3/XHRUpload] "+p+" started")})),a.upload.addEventListener("progress",(function(t){o.uppy.log("[AwsS3/XHRUpload] "+p+" progress: "+t.loaded+" / "+t.total),u.progress(),t.lengthComputable&&o.uppy.emit("upload-progress",e,{uploader:o,bytesUploaded:t.loaded,bytesTotal:t.total})})),a.addEventListener("load",(function(r){if(o.uppy.log("[AwsS3/XHRUpload] "+p+" finished"),u.done(),c.done(),o.uploaderEvents[e.id]&&(o.uploaderEvents[e.id].remove(),o.uploaderEvents[e.id]=null),i.validateStatus(r.target.status,a.responseText,a)){var s=i.getResponseData(a.responseText,a),l=s[i.responseUrlFieldName],h={status:r.target.status,body:s,uploadURL:l};return o.uppy.emit("upload-success",e,h),l&&o.uppy.log("Download "+e.name+" from "+l),t(e)}var f=i.getResponseData(a.responseText,a),m=d(a,i.getResponseError(a.responseText,a)),v={status:r.target.status,body:f};return o.uppy.emit("upload-error",e,m,v),n(m)})),a.addEventListener("error",(function(t){o.uppy.log("[AwsS3/XHRUpload] "+p+" errored"),u.done(),c.done(),o.uploaderEvents[e.id]&&(o.uploaderEvents[e.id].remove(),o.uploaderEvents[e.id]=null);var r=d(a,i.getResponseError(a.responseText,a));return o.uppy.emit("upload-error",e,r),n(r)})),a.open(i.method.toUpperCase(),i.endpoint,!0),a.withCredentials=i.withCredentials,""!==i.responseType&&(a.responseType=i.responseType),Object.keys(i.headers).forEach((function(e){a.setRequestHeader(e,i.headers[e])}));var c=o.requests.run((function(){return a.send(s),function(){u.done(),a.abort()}}),{priority:1});o._onFileRemoved(e.id,(function(){c.abort(),n(new Error("File removed"))})),o._onCancelAll(e.id,(function(){c.abort(),n(new Error("Upload cancelled"))}))}))},t._uploadRemoteFile=function(e,t,n){var r=this,i=this._getOptions(e);return new Promise((function(t,n){var h={},d=Array.isArray(i.metaFields)?i.metaFields:Object.keys(e.meta);d.forEach((function(t){h[t]=e.meta[t]}));var f=e.remote.providerOptions.provider?s:a,m=new f(r.uppy,e.remote.providerOptions);m.post(e.remote.url,o({},e.remote.body,{endpoint:i.endpoint,size:e.data.size,fieldname:i.fieldName,metadata:h,httpMethod:i.method,headers:i.headers})).then((function(s){var a=s.token,h=c(e.remote.companionUrl),d=new u({target:h+"/api/"+a,autoOpen:!1});r.uploaderEvents[e.id]=new l(r.uppy),r._onFileRemoved(e.id,(function(){d.send("pause",{}),f.abort(),t("upload "+e.id+" was removed")})),r._onCancelAll(e.id,(function(){d.send("pause",{}),f.abort(),t("upload "+e.id+" was canceled")})),r._onRetry(e.id,(function(){d.send("pause",{}),d.send("resume",{})})),r._onRetryAll(e.id,(function(){d.send("pause",{}),d.send("resume",{})})),d.on("progress",(function(t){return p(r,t,e)})),d.on("success",(function(n){var o=i.getResponseData(n.response.responseText,n.response),s=o[i.responseUrlFieldName],a={status:n.response.status,body:o,uploadURL:s};return r.uppy.emit("upload-success",e,a),f.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null),t()})),d.on("error",(function(t){var s=t.response,a=s?i.getResponseError(s.responseText,s):o(new Error(t.error.message),{cause:t.error});r.uppy.emit("upload-error",e,a),f.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null),n(a)}));var f=r.requests.run((function(){return d.open(),e.isPaused&&d.send("pause",{}),function(){return d.close()}}))})).catch((function(t){r.uppy.emit("upload-error",e,t),n(t)}))}))},e}()},f0f4:function(e,t){var n=function(){function e(e,t){this._timeout=e,this._onTimedOut=t,this._isDone=!1,this._aliveTimer=null,this._onTimedOut=this._onTimedOut.bind(this)}var t=e.prototype;return t.progress=function(){this._isDone||this._timeout>0&&(this._aliveTimer&&clearTimeout(this._aliveTimer),this._aliveTimer=setTimeout(this._onTimedOut,this._timeout))},t.done=function(){this._aliveTimer&&(clearTimeout(this._aliveTimer),this._aliveTimer=null),this._isDone=!0},e}();e.exports=n}}]);